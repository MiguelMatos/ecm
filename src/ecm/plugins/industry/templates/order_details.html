{% extends "base.html" %}

{% block headtitle %}Order #{{ order.id }} Details{% endblock %}

{% block stylesheets %}
<link rel="stylesheet" type="text/css" href="/s/ecm/css/jquery.dataTables.css" />
{% endblock %}

{% block javascripts %}
<script type="text/javascript">
$(document).ready(function () {{% for transition, name in validTransitions %}
  $("#{{transition}}_button").click(function() {
      window.location = "/industry/orders/{{order.id}}/{{transition}}/";
  });
{% endfor %}});
</script>
{% endblock %}

{% block breadcrumbs %}
<li><a href="/">Home</a></li>
<li><a href="/industry">Industry</a></li>
<li><a href="/industry/orders">Orders</a></li>
<li><a href="/industry/orders/{{ order.id }}">#{{ order.id }}</a></li>
{% endblock %}

{% block main_content %}
<h1 class="pagetitle">Order #{{ order.id }} <span class="date">- {{order.state_text}}</span></h1>

<table class="transparent">
  <tbody>
    <tr>
      <td class="bold">Originator</td>
      <td class="right">{{order.originator_permalink|safe}}</td>
    </tr>
    <tr>
      <td class="bold">Manufacturer</td>
      <td class="right">{{order.manufacturer_permalink|safe}}</td>
    </tr>
    <tr>
      <td class="bold">Delivery Man</td>
      <td class="right">{{order.delivery_boy_permalink|safe}}</td>
    </tr>
    <tr>
      <td class="bold">Creation Date</td>
      <td class="right">{{order.creation_date|ecm_datetime}}</td>
    </tr>
    <tr>
      <td class="bold">Last Modified</td>
      <td class="right">{{order.last_modified|ecm_datetime}}</td>
    </tr>
    <tr>
      <td class="bold">Delivery Date</td>
      <td class="right">{{order.delivery_date|ecm_datetime}}</td>
    </tr>
    <tr>
      <td class="bold">Pricing</td>
      <td class="right">{{order.pricing}}</td>
    </tr>
    <tr>
      <td class="bold">Quote</td>
      <td class="right">{%if order.quote == 0.0%}N/A{%else%}{{row.quote|ecm_price}} ISK{%endif%}</td>
    </tr>
  </tbody>
</table>

<div>
  {% for transition, name in validTransitions %}
  <input type="button" class="button" id="{{transition}}_button" value="{{name}}"/>
  {% endfor %}
</div>

<h1>Items</h1>

<table class="order_table">
    <thead>
      <tr>
      <th style="width: 10%;">Icon</th>
      <th style="width: 30%;">Item</th>
      <th style="width: 20%;">Quantity</th>
      <th style="width: 40%;">Price</th>
      </tr>
    </thead>
  <tbody>
    {% for row in order.rows.all %}
    <tr>
          <td class="center"><img src="http://image.eveonline.com/Type/{{row.catalog_entry.typeID}}_32.png" /></td>
           <td>{{row.catalog_entry.permalink|safe}}</td>
           <td class="center">{{row.quantity|ecm_quantity}}</td>
           <td class="right">{%if row.quote == 0.0%}N/A{%else%}{{row.quote|ecm_price}} ISK{%endif%}</td>
         </tr>
         {% empty %}
         <tr id="empty">
           <td colspan="4" class="order_cart_empty" >No items in order.</td>
         </tr>
         {% endfor %}
  </tbody>
</table>

<ul>
{% for log in logs %}
  <li>{{log.date|ecm_datetime}} [{{log.state_text}}] {{log.user_permalink|safe}} - {{log.text}}</li>
{% endfor %}
</ul>

{% endblock %}
